<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:HyPrism.UI.ViewModels"
             mc:Ignorable="d" d:DesignWidth="1280" d:DesignHeight="800"
             x:Class="HyPrism.UI.Views.LoadingView"
             x:DataType="vm:LoadingViewModel">
    
    <UserControl.Styles>
        <!-- Fade transitions for logo and content -->
        <Style Selector="Image.logo, StackPanel.content">
            <Setter Property="Transitions">
                <Transitions>
                    <DoubleTransition Property="Opacity" Duration="{Binding LogoFadeDuration}" Easing="CubicEaseInOut"/>
                </Transitions>
            </Setter>
        </Style>
        
        <!-- Slower fade transition for spinner -->
        <Style Selector="Ellipse.spinner">
            <Setter Property="Transitions">
                <Transitions>
                    <DoubleTransition Property="Opacity" Duration="{Binding SpinnerFadeDuration}" Easing="CubicEaseInOut"/>
                </Transitions>
            </Setter>
        </Style>
        
        <!-- Exit animation: slide up and fade out -->
        <Style Selector="Grid.loading-container.exiting">
            <Style.Animations>
                <Animation Duration="{Binding ExitAnimationDuration}" FillMode="Forward" Easing="CubicEaseOut">
                    <KeyFrame Cue="0%">
                        <Setter Property="Opacity" Value="1"/>
                        <Setter Property="(TranslateTransform.Y)" Value="0"/>
                    </KeyFrame>
                    <KeyFrame Cue="100%">
                        <Setter Property="Opacity" Value="0"/>
                        <Setter Property="(TranslateTransform.Y)" Value="-100"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>
        
        <!-- Spinner rotation -->
        <Style Selector="Ellipse.spinner">
            <Style.Animations>
                <Animation Duration="0:0:1.5" IterationCount="Infinite">
                    <KeyFrame Cue="0%">
                        <Setter Property="(RotateTransform.Angle)" Value="0"/>
                    </KeyFrame>
                    <KeyFrame Cue="100%">
                        <Setter Property="(RotateTransform.Angle)" Value="360"/>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>
    </UserControl.Styles>
    
    <Grid Background="#000000"
          Classes.exiting="{Binding IsExiting}"
          Classes="loading-container">
        <Grid.RenderTransform>
            <TranslateTransform/>
        </Grid.RenderTransform>
        
        <!-- Logo - centered -->
        <Image Classes="logo"
               Opacity="{Binding LogoOpacity}"
               Source="/Assets/logo.png"
               Width="200"
               Height="200"
               HorizontalAlignment="Center"
               VerticalAlignment="Center"/>
        
        <!-- Content below logo -->
        <StackPanel Classes="content"
                    Opacity="{Binding ContentOpacity}"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Margin="0,300,0,0"
                    Spacing="20">
                
            <Ellipse Classes="spinner"
                     Opacity="{Binding SpinnerOpacity}"
                     Width="48" Height="48"
                     Stroke="#4A90E2"
                     StrokeThickness="4"
                     StrokeDashArray="32,100"
                     StrokeLineCap="Round"
                     HorizontalAlignment="Center">
                <Ellipse.RenderTransform>
                    <RotateTransform Angle="0"/>
                </Ellipse.RenderTransform>
            </Ellipse>
        </StackPanel>
    </Grid>
</UserControl>
